<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SafeMolGen-DrugOracle Flowcharts</title>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; padding: 24px; background: #fafafa; margin: 0 auto; }
    .content { max-width: 900px; margin: 0 auto; }
    .mermaid-wrap--large { max-width: none; width: 100%; min-width: 1100px; overflow-x: auto; margin: 0 -24px; padding: 0 24px; }
    h1 { font-size: 1.25rem; color: #333; margin-bottom: 8px; }
    h2 { font-size: 1rem; color: #555; margin-top: 32px; margin-bottom: 12px; }
    .mermaid { background: white; padding: 32px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); display: inline-block; margin-bottom: 16px; }
    .mermaid-wrap--large .mermaid { padding: 40px; min-width: 1060px; }
    .mermaid svg { max-width: none !important; }
    .hint { margin-top: 8px; font-size: 0.875rem; color: #666; }
  </style>
</head>
<body>
  <div class="content">
  <h1>SafeMolGen-DrugOracle — Flowcharts</h1>
  <p class="hint">Right-click a diagram → Save image as… or screenshot (Cmd+Shift+4 / Win+Shift+S).</p>

  <h2>1. Workflow (top-down)</h2>
  <div class="mermaid">
flowchart TB
    Start([Start]) --> Phase1[Phase 1: Train ADMET GNN on TDC data]
    Phase1 --> Phase2[Phase 2: Train Oracle on clinical data using ADMET]
    Phase2 --> Phase3[Phase 3: Pretrain Generator on SMILES; optional RL]
    Phase3 --> Load[Load Generator + Oracle + ADMET]
    Load --> Gen[Generate N candidate SMILES]
    Gen --> Score[Score each with Oracle]
    Score --> Best[Pick best by overall probability]
    Best --> Check{Target reached or max iterations?}
    Check -->|No| Feedback[Optionally use Oracle feedback next iteration]
    Feedback --> Gen
    Check -->|Yes| End([Return best molecule])
  </div>
  </div>

  <h2>2. Project architecture (top-down)</h2>
  <p class="hint">Pipeline (top) calls Generator and Oracle (below). Generator returns SMILES; Oracle returns phase probs, alerts, recs.</p>
  <div class="mermaid">
flowchart TB
    P["Pipeline · SafeMolGenDrugOracle<br/>Design loop, filters, Oracle feedback"]
    G["Generator · SafeMolGen<br/>Tokenizer → Transformer"]
    O["Oracle · DrugOracle<br/>Graph → GNN → 22-D → Phase I/II/III, Alerts, Recs"]
    P --> G
    P --> O
  </div>

  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'neutral',
      flowchart: {
        useMaxWidth: false,
        htmlLabels: true,
        curve: 'basis',
        padding: 40,
        nodeSpacing: 80,
        rankSpacing: 60,
      },
      themeVariables: {
        fontSize: '17px',
        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
        primaryTextColor: '#1a1a1a',
        primaryBorderColor: '#333',
        lineColor: '#444',
        secondaryBorderColor: '#555',
        tertiaryColor: '#f8f8f8',
        tertiaryBorderColor: '#ccc',
        tertiaryTextColor: '#222',
        nodeBorder: '#333',
        clusterBorder: '#444',
        clusterBkg: '#f5f5f5',
        titleColor: '#1a1a1a',
        edgeLabelBackground: '#fff',
        textColor: '#1a1a1a',
        mainBkg: '#fff',
      },
    });
  </script>
</body>
</html>
